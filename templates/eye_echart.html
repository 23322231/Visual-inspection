<!-- 顯示視力表的頁面 -->
<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>調整視力測驗圖片大小</title>
    <style>
        body {
            text-align: center;
            font-family: Arial, sans-serif;
        }
        #referenceObject {
            border: 2px solid #000;
            width: 100px; /* 初始寬度，可調整 */
            height: 54mm; /* 信用卡的標準高度 (5.4公分) */
            resize: both; /* 允許水平和垂直調整 */
            overflow: auto;
            margin: 20px auto;
        }
        .instruction {
            margin-top: 20px;
            font-size: 16px;
        }
    </style>
</head>
<body>
    <h1>調整視力測驗圖片大小</h1>
    <p class="instruction">將信用卡（或已知尺寸的物品）放在螢幕上，並調整黑框使其尺寸與物品相符。</p>
    
    <!-- 可調整的參考物 -->
    <div id="referenceObject"></div>
    
    <p class="instruction">調整後的寬度：<span id="widthDisplay">100</span> 像素</p>
    <p class="instruction">調整後的高度：<span id="heightDisplay">54</span> 像素</p>
    <button onclick="calculatePPI()">設定圖片大小</button>
    
    <!-- 顯示 PPI 和螢幕尺寸計算結果 -->
    <p class="instruction">計算出的 PPI：<span id="ppiDisplay">尚未計算</span></p>
    <p class="instruction">計算出的螢幕尺寸：<span id="screenSizeDisplay">尚未計算</span> 英吋</p>
    
    <!-- 視力測驗的圖片 -->
    <div>
        <p class="instruction">視力測驗圖片：</p>
        <img id="testImage" src="static/e_chart/E_right.jpg" style="display:none;" />
    </div>

    <script>
        const referenceObject = document.getElementById('referenceObject');
        const widthDisplay = document.getElementById('widthDisplay');
        const heightDisplay = document.getElementById('heightDisplay');
        const ppiDisplay = document.getElementById('ppiDisplay');
        const screenSizeDisplay = document.getElementById('screenSizeDisplay');
        const errorDisplay = document.getElementById('errorDisplay');
        const testImage = document.getElementById('testImage');
        const knownWidthCm = 8.56; // 信用卡的寬度（公分）
        const knownHeightCm = 5.4; // 信用卡的高度（公分）
        

        // 更新顯示寬度和高度
        referenceObject.addEventListener('mousemove', updateSize);
        function updateSize() {
            const width = referenceObject.offsetWidth;
            const height = referenceObject.offsetHeight;
            widthDisplay.textContent = width;
            heightDisplay.textContent = height;
        }

        // 計算 PPI 並顯示螢幕尺寸和誤差
        function calculatePPI() {
            const widthPx = referenceObject.offsetWidth;
            const heightPx = referenceObject.offsetHeight;

            const widthInch = knownWidthCm / 2.54; // 將公分轉換為英吋
            const heightInch = knownHeightCm / 2.54; // 將公分轉換為英吋

            const ppi = widthPx / widthInch;

            // 顯示計算出的 PPI
            ppiDisplay.textContent = ppi.toFixed(2);

            // 取得螢幕解析度（寬度和高度）
            const screenWidthPx = window.screen.width;
            const screenHeightPx = window.screen.height;
            console.log(screenWidthPx, screenHeightPx);

            // 計算螢幕的寬度和高度（英吋）
            const screenWidthInch = screenWidthPx / ppi;
            const screenHeightInch = screenHeightPx / ppi;

            // 計算螢幕的對角線尺寸（英吋）
            const screenSizeInch = Math.sqrt(screenWidthInch ** 2 + screenHeightInch ** 2);

            // 顯示螢幕尺寸
            screenSizeDisplay.textContent = screenSizeInch.toFixed(2);

            // 調整視力測驗圖片的大小（假設測驗圖片需要10cm寬）
            const targetWidthCm = 7.37; // 測驗圖片目標寬度
            const targetWidthPx = (targetWidthCm / 2.54) * ppi;
            testImage.style.width = `${targetWidthPx}px`;
            testImage.style.display = 'block';
        }
    </script>
</body>
</html>
